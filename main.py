# main.py
# Автор: Федотова Анастасия Алексеевна
# Тема ВКР:
# «Автоматическая генерация и проверка учебных заданий
# по языку программирования Python с помощью нейронных сетей
# (на примере ЧОУ ВО „Московский университет имени С.Ю. Витте“)»

from ml.task_generator import generate_task
from ml.predict import predict


def main():
    print("=" * 60)
    print("ИНТЕЛЛЕКТУАЛЬНЫЙ СЕРВИС ПРОВЕРКИ ЗАДАНИЙ ПО PYTHON")
    print("=" * 60)

    # -------------------------------------------------
    # 1. Генерация учебного задания
    # -------------------------------------------------
    try:
        task = generate_task()
    except Exception as e:
        print("Ошибка генерации задания:", e)
        return

    print("\nЗАДАНИЕ:")
    print(task["task_text"])
    print("\nУсловие:")
    print("— Напишите решение на Python")
    print("— Результат должен быть записан в переменную result")
    print("-" * 60)

    # -------------------------------------------------
    # 2. Ввод решения пользователя
    # -------------------------------------------------
    print("Введите решение (Python-код).")
    print("Для завершения ввода напишите строку END.\n")

    user_code_lines = []

    while True:
        line = input()
        if line.strip() == "END":
            break
        user_code_lines.append(line)

    user_code = "\n".join(user_code_lines)

    if not user_code.strip():
        print("Ошибка: решение не введено.")
        return

    # -------------------------------------------------
    # 3. Проверка решения
    # -------------------------------------------------
    print("\nПРОВЕРКА РЕШЕНИЯ...")
    result = predict(task, user_code)

    # -------------------------------------------------
    # 4. Вывод результата
    # -------------------------------------------------
    print("\nРЕЗУЛЬТАТ ПРОВЕРКИ:")
    print(result)
    print("=" * 60)


if __name__ == "__main__":
    main()
